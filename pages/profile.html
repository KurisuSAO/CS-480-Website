<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Anime List</title>
    <!-- Load style sheets -->
    <link rel="stylesheet" href=
  "https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css">

    <link rel="stylesheet" href="styleProfile.css">

    <!-- Load any supplemental Javascript libraries here -->
    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>


    

  </head>
  <body style="background-color:mintcream">
    
    <!-- from example 
    <ul>
      <li class="list"><a href="/db">Query the database</a></li>
    </ul>
    -->
    <div id="fullPage">

      <!-- Side bar -->
      <div id="sidebar">
        <ul class="sidebar-nav">
          <li>
            <img src="user.png" class="card-img-top" alt="Default User" width="200" height="200">
          </li>
          <br>
          <li><h5 class="card-title" id='userName'>UserName</h5></li>
          <li>  
            <p>Some quick example text to build on the card title and make up the bulk of the card's content.</p>
          </li>
          <li>
                <a href="#" class="btn btn-light" id="btnList">List</a>
          </li>
        </ul>
      </div> 
      
      <!-- Stats -->
      <div id="statsContent">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-4" id="firstColumn">
              <div class="card">
                <div class="card-header">Total Days</div>
                <div class="card-body" id="dayStat">Content</div>
              </div>
            </div>
            <div class="col-lg-4" id="secondColumn">
              <div class="card">
                <div class="card-header">Total Shows</div>
                <div class="card-body" id="showStat">Content</div>
              </div>
            </div>
            <div class="col-lg-4" id="thirdColumn">
              <div class="card">
                <div class="card-header">Total Episodes</div>
                <div class="card-body" id="epStat">Content</div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12" id="firstColumn">
              <div class="card">
                <div class="card-header">Year Ranges of Shows</div>
                <div class="card-body">
                  <canvas id="yearGraph" width="800" height="150"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>
  </body>
  <script>

  //what happens as soon as page loads
  $(document).ready(function()
  {
    //alert(sessionStorage.getItem("curUser"));
    document.getElementById("userName").innerHTML = sessionStorage.getItem("curUser");
    var curID = sessionStorage.getItem("curID");
    var input = {id: curID};
    $.ajax({
          type: 'POST',
          url: '/profile.html/days',
          data: input,
          success: function(data){
            //alert(data);
            document.getElementById("dayStat").innerHTML = data[0];
            document.getElementById("epStat").innerHTML = data[1];
            document.getElementById("showStat").innerHTML = data[2];
            //alert(data[3]);
            makeYearGraph(data[3]);

          }
    });

  });

  function makeYearGraph(tuple){
      var x = [];
      var y = [];
      for(var i = 0; i < tuple.length; ++i){
        x.push(tuple[i][0]);
        y.push(tuple[i][1]);
      }
      var ctx = document.getElementById('yearGraph');
      var lineGraph = new Chart(ctx, {
      type: 'line',
      data: {
        labels: x,
        datasets: [{ 
          data: y,
          borderColor: "#FA8072"
        }]

        
      },
      options: {
        legend: {
          display: false
        }
      }
  });
  }

  //Event Handlers
      
  </script>
</html>